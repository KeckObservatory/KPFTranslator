{
    "metadata": {
        "instrument": "KPF",
        "name": "kpf_sci",
        "script": "BEGIN_SLEW                    # Starts telescope slew\nCONFIGURE_SCIENCE             # Sets: shutters, octagon, lamp\nCONFIGURE_FOR_ACQUISITION     # Sets: guide camera parameters, fold mirror position\nWAITFOR_CONFIGURE_ACQUISITION # (For long slew, this returns first, slew blocks)\nWAITFOR_SLEW                  # (For short slew, this is done and does not block)\nACQUIRE                       # OA acquires to PO and starts tip tilt loop\nWAITFOR_ACQUIRE               # Returns when tip tilt loop is closed\nWAITFOR_CONFIGURE_SCIENCE     # (For long slew, this is already done. For short slew, might wait on octagon)\nEXECUTE_OBSERVATION           # Ends on Readout\n",
        "script_version": "0.4.0",
        "template_type": "science",
        "ui_name": "KPF science",
        "version": "0.4.0"
    },
    "parameters": {
        "guide_camgain": {
            "allowed": [
                "high",
                "medium",
                "low"
            ],
            "default": "high",
            "description": "Only used if guide mode is manual",
            "option": "set",
            "optionality": "required",
            "type": "str",
            "ui_name": "Guider camera gain (high, medium, or low).",
            "units": null
        },
        "guide_fps": {
            "allowed": [
                0.01,
                400
            ],
            "default": 100,
            "description": "Only used if guide mode is manual",
            "option": "range",
            "optionality": "required",
            "type": "float",
            "ui_name": "Guider frames per second.",
            "units": null
        },
        "guide_loopgain": {
            "allowed": [
                0.01,
                1
            ],
            "default": 0.2,
            "description": "Tip tilt loop gain",
            "option": "range",
            "optionality": "required",
            "type": "float",
            "ui_name": "Tip tilt loop gain",
            "units": null
        },
        "guide_mode": {
            "allowed": [
                "off",
                "telescope",
                "manual",
                "auto"
            ],
            "default": "manual",
            "description": "off = do not guide,\ntelescope = use slow telescope guiding only,\nmanual = use tip tilt with manually configured exposure parameters,\nauto = use tip tilt with automatically configured exposure parameters",
            "option": "set",
            "optionality": "required",
            "type": "str",
            "ui_name": "Guide camera exposure mode.",
            "units": null
        },
        "obs_sequence": {
            "allowed": {
                "calnd1": {
                    "allowed": [
                        "OD 0.1",
                        "OD 1.0",
                        "OD 1.3",
                        "OD 2.0",
                        "OD 3.0",
                        "OD 4.0"
                    ],
                    "default": "OD 0.1",
                    "description": "Filter to use in the ND1 filter wheel",
                    "option": "set",
                    "optionality": "required",
                    "type": "str",
                    "ui_name": "Filter to use in the ND1 filter wheel",
                    "units": null
                },
                "calnd2": {
                    "allowed": [
                        "OD 0.1",
                        "OD 0.3",
                        "OD 0.5",
                        "OD 0.8",
                        "OD 1.0",
                        "OD 4.0"
                    ],
                    "default": "OD 0.1",
                    "description": "Filter to use in the ND2 filter wheel",
                    "option": "set",
                    "optionality": "required",
                    "type": "str",
                    "ui_name": "Filter to use in the ND2 filter wheel",
                    "units": null
                },
                "calsource": {
                    "allowed": [
                        "Home",
                        "EtalonFiber",
                        "BrdbandFiber",
                        "U_gold",
                        "U_daily",
                        "Th_daily",
                        "Th_gold",
                        "SoCal-CalFib",
                        "LFCFiber"
                    ],
                    "default": "Home",
                    "description": "Calibration source to use",
                    "option": "set",
                    "optionality": "required",
                    "type": "str",
                    "ui_name": "Calibration source to use",
                    "units": null
                },
                "em_band": {
                    "allowed": [
                        1,
                        2,
                        3,
                        4
                    ],
                    "default": 1,
                    "description": "Which wavelength band of the exposure meter to use for termination condition?",
                    "option": "set",
                    "optionality": "optional",
                    "type": "int",
                    "ui_name": "Which wavelength band of the exposure meter to use for termination condition?",
                    "units": null
                },
                "em_exptime": {
                    "allowed": [
                        0.1,
                        1800
                    ],
                    "default": 1,
                    "description": "Exposure time in seconds",
                    "option": "range",
                    "optionality": "required",
                    "type": "float",
                    "ui_name": "Exposure time in seconds",
                    "units": "s"
                },
                "em_flux": {
                    "allowed": [
                        1,
                        1000000000.0
                    ],
                    "default": 100000.0,
                    "description": "What flux value should trigger the exposure termination?",
                    "option": "range",
                    "optionality": "optional",
                    "type": "float",
                    "ui_name": "What flux value should trigger the exposure termination?",
                    "units": null
                },
                "em_mode": {
                    "allowed": [
                        "off",
                        "telescope",
                        "manual",
                        "auto"
                    ],
                    "default": "manual",
                    "description": "off = do not take EM exposures,\nmonitor = take EM exposures, but do not use for exposure termination,\ntrigger = take EM exposures and use for exposure termination,\nauto = take EM exposures using automatic exposure time and use for exposure termination",
                    "option": "set",
                    "optionality": "required",
                    "type": "str",
                    "ui_name": "Exposure meter mode.",
                    "units": null
                },
                "exptime": {
                    "allowed": [
                        0.1,
                        3600
                    ],
                    "default": 1,
                    "description": "Exposure time in seconds",
                    "option": "range",
                    "optionality": "required",
                    "type": "float",
                    "ui_name": "Exposure time in seconds",
                    "units": "seconds"
                },
                "n_exposures": {
                    "allowed": [
                        1,
                        1000
                    ],
                    "default": 1,
                    "description": "Number of exposures to take",
                    "option": "range",
                    "optionality": "required",
                    "type": "int",
                    "ui_name": "Number of exposures to take",
                    "units": null
                },
                "object": {
                    "default": "",
                    "description": "Value for the object keyword (comment for the observer)",
                    "option": "open",
                    "optionality": "optional",
                    "type": "string",
                    "ui_name": "Value for the object keyword",
                    "units": null
                },
                "ts_simulcal": {
                    "default": false,
                    "description": "Should the timed shutter for simultaneous calibration fiber be opened during exposure?",
                    "option": "boolean",
                    "optionality": "required",
                    "type": "boolean",
                    "ui_name": "Should the timed shutter for simultaneous calibration fiber be opened during exposure?",
                    "units": null
                }
            },
            "description": "Observation sequence",
            "option": "set",
            "optionality": "required",
            "type": "array",
            "ui_name": "Observation sequence",
            "units": null
        },
        "target_2mass_id": {
            "description": "The 2MASS ID of the target",
            "optionality": "required",
            "type": "string",
            "ui_name": "The 2MASS ID of the target",
            "units": null
        },
        "target_gaia_id": {
            "description": "The GAIA DR3 ID of the target",
            "optionality": "required",
            "type": "string",
            "ui_name": "The GAIA DR3 ID of the target",
            "units": null
        },
        "target_gmag": {
            "allowed": [
                -30,
                30
            ],
            "default": 0,
            "description": "Gaia G magnitude of target",
            "option": "range",
            "optionality": "required",
            "type": "float",
            "ui_name": "Gaia G magnitude of target",
            "units": null
        },
        "target_jmag": {
            "allowed": [
                -30,
                30
            ],
            "default": 0,
            "description": "2MASS J magnitude of target",
            "option": "range",
            "optionality": "required",
            "type": "float",
            "ui_name": "2MASS J magnitude of target",
            "units": null
        },
        "target_name": {
            "description": "observer provided name",
            "optionality": "required",
            "type": "string",
            "ui_name": "observer provided name",
            "units": null
        },
        "target_parallax": {
            "allowed": [
                0,
                1000000.0
            ],
            "default": 0,
            "description": "Parallax in milliarcseconds; needed for DRP not pointing telescope",
            "option": "range",
            "optionality": "required",
            "type": "float",
            "ui_name": "Parallax in milliarcseconds",
            "units": "mas"
        },
        "target_rv": {
            "allowed": [
                -1000000.0,
                1000000.0
            ],
            "default": 0,
            "description": "Radial velocity in km/s; needed for DRP",
            "option": "range",
            "optionality": "required",
            "type": "float",
            "ui_name": "Radial velocity",
            "units": "km/s"
        },
        "target_teff": {
            "allowed": [
                0,
                1000000.0
            ],
            "default": 0,
            "description": "Teff of target in K",
            "option": "range",
            "optionality": "required",
            "type": "float",
            "ui_name": "Effective Temperature",
            "units": "K"
        },
        "triggercahk": {
            "default": false,
            "description": "Trigger the Ca H&K detector?",
            "option": "boolean",
            "optionality": "required",
            "type": "boolean",
            "ui_name": "Trigger the Ca H&K detector?",
            "units": null
        },
        "triggergreen": {
            "default": false,
            "description": "Trigger the green detector?",
            "option": "boolean",
            "optionality": "required",
            "type": "boolean",
            "ui_name": "Trigger the green detector?",
            "units": null
        },
        "triggerred": {
            "default": false,
            "description": "Trigger the red detector?",
            "option": "boolean",
            "optionality": "required",
            "type": "boolean",
            "ui_name": "Trigger the red detector?",
            "units": null
        }
    }
}